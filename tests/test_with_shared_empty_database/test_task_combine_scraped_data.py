from tests.util import (  # GAME_ID_PATCH_PFX,
    combine_scraped_data_for_game,
    COMBINED_DATA_GAME_DICT,
    GAME_ID_EXTRA_PFX_REMOVED,
    GAME_ID_FIX_START_TIME,
    GAME_ID_NO_ERRORS,
    GAME_ID_NO_PFX_FOR_PITCH_APP,
    GAME_ID_PATCH_BOXSCORE,
    GAME_ID_PFX_OUT_OF_SEQUENCE,
    GAME_ID_WITH_ERRORS,
    NO_ERRORS_PITCH_APP,
    update_scraped_bbref_games_for_date,
    update_scraped_boxscore,
    update_scraped_brooks_games_for_date,
    update_scraped_pitch_logs,
    update_scraped_pitchfx_logs,
)

# from vigorish.database import GameScrapeStatus, PitchAppScrapeStatus
from vigorish.database import PitchAppScrapeStatus
from vigorish.status.update_status_combined_data import update_pitch_apps_with_combined_data
from vigorish.tasks.combine_scraped_data import CombineScrapedDataTask

# from vigorish.tasks.patch_all_invalid_pfx import PatchAllInvalidPitchFxTask, PatchInvalidPitchFxTask
# from vigorish.util.exceptions import ScrapedDataException


def create_test_data(vig_app, test_id):
    game_date = COMBINED_DATA_GAME_DICT[test_id]["game_date"]
    bbref_game_id = COMBINED_DATA_GAME_DICT[test_id]["bbref_game_id"]
    bb_game_id = COMBINED_DATA_GAME_DICT[test_id]["bb_game_id"]
    update_scraped_bbref_games_for_date(vig_app, game_date)
    update_scraped_brooks_games_for_date(vig_app, game_date)
    update_scraped_boxscore(vig_app, bbref_game_id)
    update_scraped_pitch_logs(vig_app, game_date, bbref_game_id)
    update_scraped_pitchfx_logs(vig_app, bb_game_id)
    vig_app.db_session.commit()


def test_combine_data_no_errors(vig_app):
    test_id = "NO_ERRORS"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_NO_ERRORS)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 298,
        "pitch_count_bbref": 298,
        "pitch_count_pitchfx": 298,
        "batters_faced_bbref": 82,
        "batters_faced_pitchfx": 82,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 82,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "TOR201906170_01_TOR_571882_ANA_600303_0",
            "TOR201906170_01_TOR_571882_ANA_545361_0",
            "TOR201906170_01_TOR_571882_ANA_660271_0",
            "TOR201906170_01_ANA_472610_TOR_519299_0",
            "TOR201906170_01_ANA_472610_TOR_624415_0",
            "TOR201906170_01_ANA_472610_TOR_665489_0",
            "TOR201906170_01_ANA_472610_TOR_642133_0",
            "TOR201906170_02_TOR_429719_ANA_457708_0",
            "TOR201906170_02_TOR_429719_ANA_594777_0",
            "TOR201906170_02_TOR_429719_ANA_664058_0",
            "TOR201906170_02_TOR_429719_ANA_571506_0",
            "TOR201906170_02_TOR_429719_ANA_518960_0",
            "TOR201906170_02_TOR_429719_ANA_541600_0",
            "TOR201906170_02_TOR_429719_ANA_600303_0",
            "TOR201906170_02_TOR_429719_ANA_545361_0",
            "TOR201906170_02_TOR_429719_ANA_660271_0",
            "TOR201906170_02_TOR_429719_ANA_457708_1",
            "TOR201906170_02_TOR_543208_ANA_594777_0",
            "TOR201906170_02_ANA_570240_TOR_606192_0",
            "TOR201906170_02_ANA_570240_TOR_545341_0",
            "TOR201906170_02_ANA_570240_TOR_520471_0",
            "TOR201906170_03_TOR_543208_ANA_664058_0",
            "TOR201906170_03_TOR_543208_ANA_571506_0",
            "TOR201906170_03_TOR_543208_ANA_518960_0",
            "TOR201906170_03_TOR_543208_ANA_541600_0",
            "TOR201906170_03_TOR_543208_ANA_600303_0",
            "TOR201906170_03_ANA_570240_TOR_592273_0",
            "TOR201906170_03_ANA_570240_TOR_571912_0",
            "TOR201906170_03_ANA_570240_TOR_519299_0",
            "TOR201906170_04_TOR_543208_ANA_545361_0",
            "TOR201906170_04_TOR_543208_ANA_660271_0",
            "TOR201906170_04_TOR_543208_ANA_457708_0",
            "TOR201906170_04_ANA_570240_TOR_624415_0",
            "TOR201906170_04_ANA_570240_TOR_665489_0",
            "TOR201906170_04_ANA_570240_TOR_642133_0",
            "TOR201906170_04_ANA_570240_TOR_606192_0",
            "TOR201906170_05_TOR_543208_ANA_594777_0",
            "TOR201906170_05_TOR_543208_ANA_664058_0",
            "TOR201906170_05_TOR_543208_ANA_571506_0",
            "TOR201906170_05_TOR_543208_ANA_518960_0",
            "TOR201906170_05_ANA_570240_TOR_545341_0",
            "TOR201906170_05_ANA_570240_TOR_520471_0",
            "TOR201906170_05_ANA_570240_TOR_592273_0",
            "TOR201906170_06_TOR_592468_ANA_541600_0",
            "TOR201906170_06_TOR_592468_ANA_600303_0",
            "TOR201906170_06_TOR_592468_ANA_545361_0",
            "TOR201906170_06_TOR_592468_ANA_660271_0",
            "TOR201906170_06_TOR_592468_ANA_457708_0",
            "TOR201906170_06_TOR_592468_ANA_594777_0",
            "TOR201906170_06_ANA_570240_TOR_571912_0",
            "TOR201906170_06_ANA_570240_TOR_519299_0",
            "TOR201906170_06_ANA_570240_TOR_624415_0",
            "TOR201906170_06_ANA_570240_TOR_665489_0",
            "TOR201906170_07_TOR_475479_ANA_664058_0",
            "TOR201906170_07_TOR_475479_ANA_571506_0",
            "TOR201906170_07_TOR_475479_ANA_518960_0",
            "TOR201906170_07_TOR_475479_ANA_541600_0",
            "TOR201906170_07_ANA_570240_TOR_642133_0",
            "TOR201906170_07_ANA_570240_TOR_666971_0",
            "TOR201906170_07_ANA_570240_TOR_545341_0",
            "TOR201906170_07_ANA_570240_TOR_520471_0",
            "TOR201906170_07_ANA_570240_TOR_592273_0",
            "TOR201906170_07_ANA_570240_TOR_571912_0",
            "TOR201906170_08_TOR_641835_ANA_600303_0",
            "TOR201906170_08_TOR_641835_ANA_545361_0",
            "TOR201906170_08_TOR_641835_ANA_660271_0",
            "TOR201906170_08_TOR_641835_ANA_457708_0",
            "TOR201906170_08_ANA_570240_TOR_519299_0",
            "TOR201906170_08_ANA_570240_TOR_624415_0",
            "TOR201906170_08_ANA_598287_TOR_665489_0",
            "TOR201906170_08_ANA_598287_TOR_642133_0",
            "TOR201906170_08_ANA_598287_TOR_666971_0",
            "TOR201906170_08_ANA_598287_TOR_545341_0",
            "TOR201906170_08_ANA_621142_TOR_520471_0",
            "TOR201906170_09_TOR_543339_ANA_594777_0",
            "TOR201906170_09_TOR_543339_ANA_664058_0",
            "TOR201906170_09_TOR_543339_ANA_571506_0",
            "TOR201906170_09_TOR_543339_ANA_518960_0",
            "TOR201906170_09_TOR_543339_ANA_541600_0",
            "TOR201906170_09_ANA_605121_TOR_592273_0",
            "TOR201906170_09_ANA_605121_TOR_571912_0",
            "TOR201906170_09_ANA_605121_TOR_519299_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }

    pitch_app_status = PitchAppScrapeStatus.find_by_pitch_app_id(vig_app.db_session, NO_ERRORS_PITCH_APP)
    assert pitch_app_status
    assert pitch_app_status.combined_pitchfx_bbref_data == 0
    assert pitch_app_status.pitch_count_pitch_log == 38
    assert pitch_app_status.pitch_count_bbref == 38
    assert pitch_app_status.pitch_count_pitchfx == 38
    assert pitch_app_status.pitch_count_pitchfx_audited == 0
    assert pitch_app_status.missing_pitchfx_count == 0
    assert pitch_app_status.batters_faced_bbref == 10
    assert pitch_app_status.total_at_bats_pitchfx_complete == 0
    assert pitch_app_status.total_at_bats_missing_pitchfx == 0

    result = update_pitch_apps_with_combined_data(vig_app.db_session, combined_data)
    assert result.success

    assert pitch_app_status.combined_pitchfx_bbref_data == 1
    assert pitch_app_status.pitch_count_pitch_log == 38
    assert pitch_app_status.pitch_count_bbref == 38
    assert pitch_app_status.pitch_count_pitchfx == 38
    assert pitch_app_status.pitch_count_pitchfx_audited == 38
    assert pitch_app_status.missing_pitchfx_count == 0
    assert pitch_app_status.batters_faced_bbref == 10
    assert pitch_app_status.total_at_bats_pitchfx_complete == 10
    assert pitch_app_status.total_at_bats_missing_pitchfx == 0
    vig_app.db_session.commit()


def test_combine_data_with_errors(vig_app):
    test_id = "WITH_ERRORS"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_WITH_ERRORS)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 334,
        "pitch_count_bbref": 334,
        "pitch_count_pitchfx": 334,
        "batters_faced_bbref": 83,
        "batters_faced_pitchfx": 83,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 83,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "NYA201906112_01_NYA_572020_NYN_643446_0",
            "NYA201906112_01_NYA_572020_NYN_605204_0",
            "NYA201906112_01_NYA_572020_NYN_624413_0",
            "NYA201906112_01_NYA_572020_NYN_453943_0",
            "NYA201906112_01_NYA_572020_NYN_624424_0",
            "NYA201906112_01_NYA_572020_NYN_467092_0",
            "NYA201906112_01_NYN_450306_NYA_518934_0",
            "NYA201906112_01_NYN_450306_NYA_572228_0",
            "NYA201906112_01_NYN_450306_NYA_596142_0",
            "NYA201906112_01_NYN_450306_NYA_650402_0",
            "NYA201906112_01_NYN_450306_NYA_640449_0",
            "NYA201906112_02_NYA_572020_NYN_642708_0",
            "NYA201906112_02_NYA_572020_NYN_588751_0",
            "NYA201906112_02_NYA_572020_NYN_460576_0",
            "NYA201906112_02_NYA_572020_NYN_643446_0",
            "NYA201906112_02_NYN_450306_NYA_570482_0",
            "NYA201906112_02_NYN_450306_NYA_457727_0",
            "NYA201906112_02_NYN_450306_NYA_519222_0",
            "NYA201906112_02_NYN_450306_NYA_458731_0",
            "NYA201906112_03_NYA_572020_NYN_605204_0",
            "NYA201906112_03_NYA_572020_NYN_624413_0",
            "NYA201906112_03_NYA_572020_NYN_453943_0",
            "NYA201906112_03_NYA_572020_NYN_624424_0",
            "NYA201906112_03_NYA_572020_NYN_467092_0",
            "NYA201906112_03_NYA_572020_NYN_642708_0",
            "NYA201906112_03_NYA_572020_NYN_588751_0",
            "NYA201906112_03_NYA_664856_NYN_460576_0",
            "NYA201906112_03_NYN_450306_NYA_518934_0",
            "NYA201906112_03_NYN_450306_NYA_572228_0",
            "NYA201906112_03_NYN_450306_NYA_596142_0",
            "NYA201906112_03_NYN_450306_NYA_650402_0",
            "NYA201906112_03_NYN_450306_NYA_640449_0",
            "NYA201906112_03_NYN_450306_NYA_570482_0",
            "NYA201906112_03_NYN_450306_NYA_457727_0",
            "NYA201906112_04_NYA_664856_NYN_643446_0",
            "NYA201906112_04_NYA_664856_NYN_605204_0",
            "NYA201906112_04_NYA_664856_NYN_624413_0",
            "NYA201906112_04_NYA_664856_NYN_453943_0",
            "NYA201906112_04_NYA_664856_NYN_624424_0",
            "NYA201906112_04_NYA_664856_NYN_467092_0",
            "NYA201906112_04_NYN_450306_NYA_519222_0",
            "NYA201906112_04_NYN_450306_NYA_458731_0",
            "NYA201906112_04_NYN_450306_NYA_518934_0",
            "NYA201906112_04_NYN_450306_NYA_572228_0",
            "NYA201906112_04_NYN_450306_NYA_596142_0",
            "NYA201906112_05_NYA_664856_NYN_642708_0",
            "NYA201906112_05_NYA_664856_NYN_588751_0",
            "NYA201906112_05_NYA_664856_NYN_460576_0",
            "NYA201906112_05_NYA_664856_NYN_643446_0",
            "NYA201906112_05_NYA_664856_NYN_605204_0",
            "NYA201906112_05_NYN_450306_NYA_650402_0",
            "NYA201906112_05_NYN_450306_NYA_640449_0",
            "NYA201906112_05_NYN_450306_NYA_570482_0",
            "NYA201906112_06_NYA_664856_NYN_624413_0",
            "NYA201906112_06_NYA_664856_NYN_453943_0",
            "NYA201906112_06_NYA_664856_NYN_624424_0",
            "NYA201906112_06_NYA_664856_NYN_467092_0",
            "NYA201906112_06_NYN_450306_NYA_457727_0",
            "NYA201906112_06_NYN_450306_NYA_519222_0",
            "NYA201906112_06_NYN_450306_NYA_458731_0",
            "NYA201906112_07_NYA_664856_NYN_642708_0",
            "NYA201906112_07_NYA_664856_NYN_588751_0",
            "NYA201906112_07_NYA_664856_NYN_460576_0",
            "NYA201906112_07_NYN_544727_NYA_518934_0",
            "NYA201906112_07_NYN_544727_NYA_572228_0",
            "NYA201906112_07_NYN_544727_NYA_596142_0",
            "NYA201906112_07_NYN_544727_NYA_650402_0",
            "NYA201906112_07_NYN_544727_NYA_640449_0",
            "NYA201906112_08_NYA_570666_NYN_643446_0",
            "NYA201906112_08_NYA_570666_NYN_605204_0",
            "NYA201906112_08_NYA_570666_NYN_624413_0",
            "NYA201906112_08_NYN_607625_NYA_570482_0",
            "NYA201906112_08_NYN_607625_NYA_457727_0",
            "NYA201906112_08_NYN_607625_NYA_519222_0",
            "NYA201906112_09_NYA_605501_NYN_453943_0",
            "NYA201906112_09_NYA_605501_NYN_624424_0",
            "NYA201906112_09_NYA_605501_NYN_467092_0",
            "NYA201906112_09_NYA_605501_NYN_642708_0",
            "NYA201906112_09_NYA_605501_NYN_588751_0",
            "NYA201906112_09_NYN_543193_NYA_458731_0",
            "NYA201906112_09_NYN_543193_NYA_518934_0",
            "NYA201906112_09_NYN_543193_NYA_572228_0",
            "NYA201906112_09_NYN_543193_NYA_596142_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }
    vig_app.db_session.commit()


def test_combine_data_no_pfx_for_pitch_app(vig_app):
    test_id = "NO_PFX_FOR_PITCH_APP"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_NO_PFX_FOR_PITCH_APP)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 310,
        "pitch_count_bbref": 310,
        "pitch_count_pitchfx": 289,
        "batters_faced_bbref": 79,
        "batters_faced_pitchfx": 75,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 21,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 75,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 4,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "PIT201909070_01_PIT_643230_SLN_451594_0",
            "PIT201909070_01_PIT_643230_SLN_543939_0",
            "PIT201909070_01_PIT_643230_SLN_502671_0",
            "PIT201909070_01_PIT_643230_SLN_542303_0",
            "PIT201909070_01_SLN_425794_PIT_621028_0",
            "PIT201909070_01_SLN_425794_PIT_668804_0",
            "PIT201909070_01_SLN_425794_PIT_516782_0",
            "PIT201909070_01_SLN_425794_PIT_605137_0",
            "PIT201909070_01_SLN_425794_PIT_592567_0",
            "PIT201909070_02_PIT_643230_SLN_657557_0",
            "PIT201909070_02_PIT_643230_SLN_425877_0",
            "PIT201909070_02_PIT_643230_SLN_669242_0",
            "PIT201909070_02_PIT_643230_SLN_664056_0",
            "PIT201909070_02_SLN_425794_PIT_591741_0",
            "PIT201909070_02_SLN_425794_PIT_624428_0",
            "PIT201909070_02_SLN_425794_PIT_553869_0",
            "PIT201909070_03_PIT_643230_SLN_425794_0",
            "PIT201909070_03_PIT_643230_SLN_451594_0",
            "PIT201909070_03_PIT_643230_SLN_543939_0",
            "PIT201909070_03_PIT_643230_SLN_502671_0",
            "PIT201909070_03_PIT_643230_SLN_542303_0",
            "PIT201909070_03_PIT_643230_SLN_657557_0",
            "PIT201909070_03_PIT_643230_SLN_425877_0",
            "PIT201909070_03_SLN_425794_PIT_643230_0",
            "PIT201909070_03_SLN_425794_PIT_621028_0",
            "PIT201909070_03_SLN_425794_PIT_668804_0",
            "PIT201909070_03_SLN_425794_PIT_516782_0",
            "PIT201909070_03_SLN_425794_PIT_605137_0",
            "PIT201909070_04_PIT_643230_SLN_669242_0",
            "PIT201909070_04_PIT_643230_SLN_664056_0",
            "PIT201909070_04_PIT_643230_SLN_425794_0",
            "PIT201909070_04_SLN_425794_PIT_592567_0",
            "PIT201909070_04_SLN_425794_PIT_591741_0",
            "PIT201909070_04_SLN_425794_PIT_624428_0",
            "PIT201909070_04_SLN_425794_PIT_553869_0",
            "PIT201909070_05_PIT_643230_SLN_451594_0",
            "PIT201909070_05_PIT_643230_SLN_543939_0",
            "PIT201909070_05_PIT_643230_SLN_502671_0",
            "PIT201909070_05_SLN_425794_PIT_643230_0",
            "PIT201909070_05_SLN_425794_PIT_621028_0",
            "PIT201909070_05_SLN_425794_PIT_668804_0",
            "PIT201909070_06_PIT_643230_SLN_542303_0",
            "PIT201909070_06_PIT_643230_SLN_657557_0",
            "PIT201909070_06_PIT_643230_SLN_425877_0",
            "PIT201909070_06_PIT_643230_SLN_669242_0",
            "PIT201909070_06_PIT_643230_SLN_664056_0",
            "PIT201909070_06_PIT_605280_SLN_425794_0",
            "PIT201909070_06_PIT_605280_SLN_451594_0",
            "PIT201909070_06_SLN_425794_PIT_516782_0",
            "PIT201909070_06_SLN_425794_PIT_605137_0",
            "PIT201909070_06_SLN_425794_PIT_592567_0",
            "PIT201909070_07_PIT_605280_SLN_543939_0",
            "PIT201909070_07_PIT_605280_SLN_502671_0",
            "PIT201909070_07_PIT_605280_SLN_542303_0",
            "PIT201909070_07_PIT_605280_SLN_657557_0",
            "PIT201909070_07_PIT_605280_SLN_425877_0",
            "PIT201909070_07_PIT_605280_SLN_669242_0",
            "PIT201909070_07_SLN_425794_PIT_591741_0",
            "PIT201909070_07_SLN_425794_PIT_624428_0",
            "PIT201909070_07_SLN_425794_PIT_553869_0",
            "PIT201909070_08_PIT_664129_SLN_664056_0",
            "PIT201909070_08_PIT_664129_SLN_425794_0",
            "PIT201909070_08_PIT_664129_SLN_451594_0",
            "PIT201909070_08_PIT_664129_SLN_543939_0",
            "PIT201909070_08_PIT_664129_SLN_502671_0",
            "PIT201909070_08_PIT_664129_SLN_542303_0",
            "PIT201909070_08_SLN_658551_PIT_596012_0",
            "PIT201909070_08_SLN_658551_PIT_621028_0",
            "PIT201909070_08_SLN_658551_PIT_668804_0",
            "PIT201909070_09_PIT_571917_SLN_624641_0",
            "PIT201909070_09_PIT_571917_SLN_425877_0",
            "PIT201909070_09_PIT_571917_SLN_669242_0",
            "PIT201909070_09_PIT_571917_SLN_664056_0",
            "PIT201909070_09_PIT_571917_SLN_592660_0",
            "PIT201909070_09_PIT_571917_SLN_668227_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [
            "PIT201909070_09_SLN_594965_PIT_622569_0",
            "PIT201909070_09_SLN_594965_PIT_571467_0",
            "PIT201909070_09_SLN_594965_PIT_592567_0",
            "PIT201909070_09_SLN_594965_PIT_591741_0",
        ],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }
    vig_app.db_session.commit()


def test_combine_data_extra_pitchfx_removed(vig_app):
    test_id = "EXTRA_PFX_REMOVED"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_EXTRA_PFX_REMOVED)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 358,
        "pitch_count_bbref": 358,
        "pitch_count_pitchfx": 358,
        "batters_faced_bbref": 90,
        "batters_faced_pitchfx": 90,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 90,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "TEX201904150_01_TEX_571946_ANA_594777_0",
            "TEX201904150_01_TEX_571946_ANA_545361_0",
            "TEX201904150_01_TEX_571946_ANA_592743_0",
            "TEX201904150_01_TEX_571946_ANA_405395_0",
            "TEX201904150_01_TEX_571946_ANA_571718_0",
            "TEX201904150_01_TEX_571946_ANA_607345_0",
            "TEX201904150_01_ANA_502239_TEX_425783_0",
            "TEX201904150_01_ANA_502239_TEX_542454_0",
            "TEX201904150_01_ANA_502239_TEX_462101_0",
            "TEX201904150_01_ANA_502239_TEX_608577_0",
            "TEX201904150_01_ANA_502239_TEX_608336_0",
            "TEX201904150_02_TEX_571946_ANA_600303_0",
            "TEX201904150_02_TEX_571946_ANA_446359_0",
            "TEX201904150_02_TEX_571946_ANA_664058_0",
            "TEX201904150_02_TEX_571946_ANA_594777_0",
            "TEX201904150_02_TEX_571946_ANA_545361_0",
            "TEX201904150_02_TEX_571946_ANA_592743_0",
            "TEX201904150_02_ANA_502239_TEX_452678_0",
            "TEX201904150_02_ANA_502239_TEX_523253_0",
            "TEX201904150_02_ANA_502239_TEX_643396_0",
            "TEX201904150_02_ANA_502239_TEX_592261_0",
            "TEX201904150_03_TEX_571946_ANA_405395_0",
            "TEX201904150_03_TEX_571946_ANA_571718_0",
            "TEX201904150_03_TEX_571946_ANA_607345_0",
            "TEX201904150_03_TEX_571946_ANA_600303_0",
            "TEX201904150_03_TEX_571946_ANA_446359_0",
            "TEX201904150_03_ANA_502239_TEX_425783_0",
            "TEX201904150_03_ANA_502239_TEX_542454_0",
            "TEX201904150_03_ANA_502239_TEX_462101_0",
            "TEX201904150_03_ANA_502239_TEX_608577_0",
            "TEX201904150_03_ANA_502239_TEX_608336_0",
            "TEX201904150_03_ANA_502239_TEX_452678_0",
            "TEX201904150_04_TEX_571946_ANA_664058_0",
            "TEX201904150_04_TEX_571946_ANA_594777_0",
            "TEX201904150_04_TEX_571946_ANA_545361_0",
            "TEX201904150_04_ANA_502239_TEX_523253_0",
            "TEX201904150_04_ANA_502239_TEX_643396_0",
            "TEX201904150_04_ANA_502239_TEX_592261_0",
            "TEX201904150_04_ANA_502239_TEX_425783_0",
            "TEX201904150_04_ANA_502239_TEX_542454_0",
            "TEX201904150_05_TEX_571946_ANA_592743_0",
            "TEX201904150_05_TEX_571946_ANA_405395_0",
            "TEX201904150_05_TEX_664871_ANA_571718_0",
            "TEX201904150_05_TEX_664871_ANA_607345_0",
            "TEX201904150_05_TEX_664871_ANA_600303_0",
            "TEX201904150_05_ANA_592135_TEX_462101_0",
            "TEX201904150_05_ANA_592135_TEX_608577_0",
            "TEX201904150_05_ANA_592135_TEX_608336_0",
            "TEX201904150_05_ANA_592135_TEX_452678_0",
            "TEX201904150_05_ANA_592135_TEX_523253_0",
            "TEX201904150_05_ANA_592135_TEX_643396_0",
            "TEX201904150_05_ANA_592135_TEX_592261_0",
            "TEX201904150_05_ANA_657228_TEX_425783_0",
            "TEX201904150_06_TEX_664871_ANA_446359_0",
            "TEX201904150_06_TEX_664871_ANA_664058_0",
            "TEX201904150_06_TEX_664871_ANA_594777_0",
            "TEX201904150_06_ANA_657228_TEX_542454_0",
            "TEX201904150_06_ANA_657228_TEX_462101_0",
            "TEX201904150_06_ANA_657228_TEX_608577_0",
            "TEX201904150_06_ANA_657228_TEX_608336_0",
            "TEX201904150_06_ANA_657228_TEX_452678_0",
            "TEX201904150_06_ANA_657228_TEX_523253_0",
            "TEX201904150_06_ANA_595928_TEX_643396_0",
            "TEX201904150_07_TEX_664871_ANA_545361_0",
            "TEX201904150_07_TEX_664871_ANA_592743_0",
            "TEX201904150_07_TEX_664871_ANA_405395_0",
            "TEX201904150_07_TEX_664871_ANA_571718_0",
            "TEX201904150_07_TEX_664871_ANA_607345_0",
            "TEX201904150_07_ANA_595928_TEX_592261_0",
            "TEX201904150_07_ANA_595928_TEX_425783_0",
            "TEX201904150_07_ANA_595928_TEX_542454_0",
            "TEX201904150_07_ANA_595928_TEX_462101_0",
            "TEX201904150_07_ANA_595928_TEX_608577_0",
            "TEX201904150_08_TEX_613317_ANA_600303_0",
            "TEX201904150_08_TEX_613317_ANA_446359_0",
            "TEX201904150_08_TEX_613317_ANA_664058_0",
            "TEX201904150_08_TEX_613317_ANA_594777_0",
            "TEX201904150_08_TEX_613317_ANA_545361_0",
            "TEX201904150_08_ANA_595928_TEX_608336_0",
            "TEX201904150_08_ANA_595928_TEX_452678_0",
            "TEX201904150_08_ANA_595928_TEX_523253_0",
            "TEX201904150_08_ANA_595928_TEX_643396_0",
            "TEX201904150_08_ANA_595928_TEX_592261_0",
            "TEX201904150_08_ANA_595928_TEX_425783_0",
            "TEX201904150_09_TEX_613317_ANA_592743_0",
            "TEX201904150_09_TEX_613317_ANA_405395_0",
            "TEX201904150_09_TEX_613317_ANA_571718_0",
            "TEX201904150_09_TEX_613317_ANA_607345_0",
            "TEX201904150_09_TEX_613317_ANA_600303_0",
            "TEX201904150_09_TEX_600917_ANA_446359_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }
    vig_app.db_session.commit()


# def test_combine_data_patched_pitchfx_data(vig_app):
#     try:
#         result = vig_app.scraped_data.json_storage.get_brooks_pitchfx_patch_list_local_file(GAME_ID_PATCH_PFX)
#         if result.success and result.value.exists():
#             result.value.unlink()
#     except ScrapedDataException:
#         pass

#     test_id = "PATCH_PFX"
#     create_test_data(vig_app, test_id)
#     combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_PATCH_PFX, apply_patch_list=False)
#     assert "pitchfx_vs_bbref_audit" in combined_data
#     assert combined_data["pitchfx_vs_bbref_audit"] == {
#         "invalid_pitchfx": True,
#         "pitchfx_error": False,
#         "pitch_count_bbref_stats_table": 329,
#         "pitch_count_bbref": 329,
#         "pitch_count_pitchfx": 313,
#         "batters_faced_bbref": 78,
#         "batters_faced_pitchfx": 75,
#         "patched_pitchfx_count": 0,
#         "missing_pitchfx_count": 16,
#         "removed_pitchfx_count": 16,
#         "invalid_pitchfx_count": 16,
#         "total_at_bats_pitchfx_complete": 75,
#         "total_at_bats_patched_pitchfx": 0,
#         "total_at_bats_missing_pitchfx": 3,
#         "total_at_bats_removed_pitchfx": 11,
#         "total_at_bats_pitchfx_error": 0,
#         "total_at_bats_invalid_pitchfx": 3,
#         "at_bat_ids_pitchfx_complete": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_02_OAK_462136_BOS_502110_0",
#             "OAK201904030_02_OAK_462136_BOS_519048_0",
#             "OAK201904030_02_OAK_462136_BOS_456488_0",
#             "OAK201904030_02_OAK_462136_BOS_571788_0",
#             "OAK201904030_02_OAK_462136_BOS_596119_0",
#             "OAK201904030_02_BOS_543135_OAK_434778_0",
#             "OAK201904030_02_BOS_543135_OAK_595777_0",
#             "OAK201904030_02_BOS_543135_OAK_543760_0",
#             "OAK201904030_02_BOS_543135_OAK_657656_0",
#             "OAK201904030_02_BOS_543135_OAK_460026_0",
#             "OAK201904030_02_BOS_543135_OAK_543257_0",
#             "OAK201904030_02_BOS_543135_OAK_656305_0",
#             "OAK201904030_03_OAK_462136_BOS_598265_0",
#             "OAK201904030_03_OAK_462136_BOS_605141_0",
#             "OAK201904030_03_OAK_462136_BOS_643217_0",
#             "OAK201904030_03_BOS_543135_OAK_572039_0",
#             "OAK201904030_03_BOS_543135_OAK_501981_0",
#             "OAK201904030_03_BOS_543135_OAK_434778_0",
#             "OAK201904030_03_BOS_543135_OAK_595777_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_04_OAK_462136_BOS_502110_0",
#             "OAK201904030_04_OAK_462136_BOS_519048_0",
#             "OAK201904030_04_BOS_543135_OAK_543760_0",
#             "OAK201904030_04_BOS_543135_OAK_657656_0",
#             "OAK201904030_04_BOS_543135_OAK_460026_0",
#             "OAK201904030_04_BOS_543135_OAK_543257_0",
#             "OAK201904030_04_BOS_543135_OAK_656305_0",
#             "OAK201904030_05_OAK_462136_BOS_456488_0",
#             "OAK201904030_05_OAK_462136_BOS_571788_0",
#             "OAK201904030_05_OAK_462136_BOS_596119_0",
#             "OAK201904030_05_OAK_462136_BOS_598265_0",
#             "OAK201904030_05_BOS_543135_OAK_572039_0",
#             "OAK201904030_05_BOS_543135_OAK_501981_0",
#             "OAK201904030_05_BOS_543135_OAK_434778_0",
#             "OAK201904030_06_OAK_462136_BOS_605141_0",
#             "OAK201904030_06_OAK_462136_BOS_643217_0",
#             "OAK201904030_06_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_OAK_462136_BOS_502110_0",
#             "OAK201904030_06_OAK_488748_BOS_519048_0",
#             "OAK201904030_06_OAK_605525_BOS_456488_0",
#             "OAK201904030_06_OAK_605525_BOS_571788_0",
#             "OAK201904030_06_BOS_605155_OAK_595777_0",
#             "OAK201904030_06_BOS_605155_OAK_543760_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_06_BOS_605155_OAK_460026_0",
#             "OAK201904030_07_OAK_605525_BOS_596119_0",
#             "OAK201904030_07_OAK_605525_BOS_598265_0",
#             "OAK201904030_07_OAK_605525_BOS_605141_0",
#             "OAK201904030_07_OAK_605525_BOS_643217_0",
#             "OAK201904030_07_BOS_605155_OAK_543257_0",
#             "OAK201904030_07_BOS_605155_OAK_656305_0",
#             "OAK201904030_07_BOS_605155_OAK_572039_0",
#             "OAK201904030_07_BOS_598264_OAK_501981_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#             "OAK201904030_08_BOS_598264_OAK_543760_0",
#             "OAK201904030_08_BOS_598264_OAK_657656_0",
#             "OAK201904030_09_OAK_407845_BOS_456488_0",
#             "OAK201904030_09_OAK_407845_BOS_571788_0",
#             "OAK201904030_09_OAK_407845_BOS_596119_0",
#             "OAK201904030_09_OAK_407845_BOS_598265_0",
#             "OAK201904030_09_OAK_407845_BOS_605141_0",
#             "OAK201904030_09_OAK_433589_BOS_643217_0",
#             "OAK201904030_09_OAK_433589_BOS_646240_0",
#             "OAK201904030_09_BOS_518489_OAK_640461_0",
#             "OAK201904030_09_BOS_518489_OAK_543257_0",
#             "OAK201904030_09_BOS_518489_OAK_656305_0",
#             "OAK201904030_09_BOS_518489_OAK_572039_0",
#         ],
#         "at_bat_ids_patched_pitchfx": [],
#         "at_bat_ids_missing_pitchfx": [
#             "OAK201904030_08_OAK_465657_BOS_646240_0",
#             "OAK201904030_08_OAK_465657_BOS_502110_0",
#             "OAK201904030_08_OAK_465657_BOS_519048_0",
#         ],
#         "at_bat_ids_removed_pitchfx": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#         ],
#         "at_bat_ids_pitchfx_error": [],
#         "at_bat_ids_invalid_pitchfx": [
#             "OAK201904030_08_OAK_605525_BOS_646240_0",
#             "OAK201904030_08_OAK_605525_BOS_502110_0",
#             "OAK201904030_08_OAK_605525_BOS_519048_0",
#         ],
#     }

#     patch_invalid_pfx = PatchInvalidPitchFxTask(vig_app)
#     result = patch_invalid_pfx.execute(GAME_ID_PATCH_PFX, no_prompts=True)
#     assert result.success
#     patch_results = result.value
#     assert patch_results["created_patch_list"]
#     assert patch_results["fixed_all_errors"]
#     combined_data = vig_app.scraped_data.get_combined_game_data(GAME_ID_PATCH_PFX)
#     assert "pitchfx_vs_bbref_audit" in combined_data
#     assert combined_data["pitchfx_vs_bbref_audit"] == {
#         "invalid_pitchfx": False,
#         "pitchfx_error": False,
#         "pitch_count_bbref_stats_table": 329,
#         "pitch_count_bbref": 329,
#         "pitch_count_pitchfx": 329,
#         "batters_faced_bbref": 78,
#         "batters_faced_pitchfx": 78,
#         "patched_pitchfx_count": 16,
#         "missing_pitchfx_count": 0,
#         "removed_pitchfx_count": 18,
#         "invalid_pitchfx_count": 0,
#         "total_at_bats_pitchfx_complete": 78,
#         "total_at_bats_patched_pitchfx": 3,
#         "total_at_bats_missing_pitchfx": 0,
#         "total_at_bats_removed_pitchfx": 12,
#         "total_at_bats_pitchfx_error": 0,
#         "total_at_bats_invalid_pitchfx": 0,
#         "at_bat_ids_pitchfx_complete": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_02_OAK_462136_BOS_502110_0",
#             "OAK201904030_02_OAK_462136_BOS_519048_0",
#             "OAK201904030_02_OAK_462136_BOS_456488_0",
#             "OAK201904030_02_OAK_462136_BOS_571788_0",
#             "OAK201904030_02_OAK_462136_BOS_596119_0",
#             "OAK201904030_02_BOS_543135_OAK_434778_0",
#             "OAK201904030_02_BOS_543135_OAK_595777_0",
#             "OAK201904030_02_BOS_543135_OAK_543760_0",
#             "OAK201904030_02_BOS_543135_OAK_657656_0",
#             "OAK201904030_02_BOS_543135_OAK_460026_0",
#             "OAK201904030_02_BOS_543135_OAK_543257_0",
#             "OAK201904030_02_BOS_543135_OAK_656305_0",
#             "OAK201904030_03_OAK_462136_BOS_598265_0",
#             "OAK201904030_03_OAK_462136_BOS_605141_0",
#             "OAK201904030_03_OAK_462136_BOS_643217_0",
#             "OAK201904030_03_BOS_543135_OAK_572039_0",
#             "OAK201904030_03_BOS_543135_OAK_501981_0",
#             "OAK201904030_03_BOS_543135_OAK_434778_0",
#             "OAK201904030_03_BOS_543135_OAK_595777_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_04_OAK_462136_BOS_502110_0",
#             "OAK201904030_04_OAK_462136_BOS_519048_0",
#             "OAK201904030_04_BOS_543135_OAK_543760_0",
#             "OAK201904030_04_BOS_543135_OAK_657656_0",
#             "OAK201904030_04_BOS_543135_OAK_460026_0",
#             "OAK201904030_04_BOS_543135_OAK_543257_0",
#             "OAK201904030_04_BOS_543135_OAK_656305_0",
#             "OAK201904030_05_OAK_462136_BOS_456488_0",
#             "OAK201904030_05_OAK_462136_BOS_571788_0",
#             "OAK201904030_05_OAK_462136_BOS_596119_0",
#             "OAK201904030_05_OAK_462136_BOS_598265_0",
#             "OAK201904030_05_BOS_543135_OAK_572039_0",
#             "OAK201904030_05_BOS_543135_OAK_501981_0",
#             "OAK201904030_05_BOS_543135_OAK_434778_0",
#             "OAK201904030_06_OAK_462136_BOS_605141_0",
#             "OAK201904030_06_OAK_462136_BOS_643217_0",
#             "OAK201904030_06_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_OAK_462136_BOS_502110_0",
#             "OAK201904030_06_OAK_488748_BOS_519048_0",
#             "OAK201904030_06_OAK_605525_BOS_456488_0",
#             "OAK201904030_06_OAK_605525_BOS_571788_0",
#             "OAK201904030_06_BOS_605155_OAK_595777_0",
#             "OAK201904030_06_BOS_605155_OAK_543760_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_06_BOS_605155_OAK_460026_0",
#             "OAK201904030_07_OAK_605525_BOS_596119_0",
#             "OAK201904030_07_OAK_605525_BOS_598265_0",
#             "OAK201904030_07_OAK_605525_BOS_605141_0",
#             "OAK201904030_07_OAK_605525_BOS_643217_0",
#             "OAK201904030_07_BOS_605155_OAK_543257_0",
#             "OAK201904030_07_BOS_605155_OAK_656305_0",
#             "OAK201904030_07_BOS_605155_OAK_572039_0",
#             "OAK201904030_07_BOS_598264_OAK_501981_0",
#             "OAK201904030_08_OAK_465657_BOS_646240_0",
#             "OAK201904030_08_OAK_465657_BOS_502110_0",
#             "OAK201904030_08_OAK_465657_BOS_519048_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#             "OAK201904030_08_BOS_598264_OAK_543760_0",
#             "OAK201904030_08_BOS_598264_OAK_657656_0",
#             "OAK201904030_09_OAK_407845_BOS_456488_0",
#             "OAK201904030_09_OAK_407845_BOS_571788_0",
#             "OAK201904030_09_OAK_407845_BOS_596119_0",
#             "OAK201904030_09_OAK_407845_BOS_598265_0",
#             "OAK201904030_09_OAK_407845_BOS_605141_0",
#             "OAK201904030_09_OAK_433589_BOS_643217_0",
#             "OAK201904030_09_OAK_433589_BOS_646240_0",
#             "OAK201904030_09_BOS_518489_OAK_640461_0",
#             "OAK201904030_09_BOS_518489_OAK_543257_0",
#             "OAK201904030_09_BOS_518489_OAK_656305_0",
#             "OAK201904030_09_BOS_518489_OAK_572039_0",
#         ],
#         "at_bat_ids_patched_pitchfx": [
#             "OAK201904030_08_OAK_465657_BOS_646240_0",
#             "OAK201904030_08_OAK_465657_BOS_502110_0",
#             "OAK201904030_08_OAK_465657_BOS_519048_0",
#         ],
#         "at_bat_ids_missing_pitchfx": [],
#         "at_bat_ids_removed_pitchfx": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_08_OAK_465657_BOS_502110_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#         ],
#         "at_bat_ids_pitchfx_error": [],
#         "at_bat_ids_invalid_pitchfx": [],
#     }
#     vig_app.db_session.commit()


# def test_combine_data_patch_all_pfx_data(vig_app):
#     test_id = "PATCH_PFX"
#     create_test_data(vig_app, test_id)
#     result = vig_app.scraped_data.json_storage.get_brooks_pitchfx_patch_list_local_file(GAME_ID_PATCH_PFX)
#     if result.success and result.value.exists():
#         result.value.unlink()
#     combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_PATCH_PFX, apply_patch_list=False)
#     assert "pitchfx_vs_bbref_audit" in combined_data
#     assert combined_data["pitchfx_vs_bbref_audit"] == {
#         "invalid_pitchfx": True,
#         "pitchfx_error": False,
#         "pitch_count_bbref_stats_table": 329,
#         "pitch_count_bbref": 329,
#         "pitch_count_pitchfx": 313,
#         "batters_faced_bbref": 78,
#         "batters_faced_pitchfx": 75,
#         "patched_pitchfx_count": 0,
#         "missing_pitchfx_count": 16,
#         "removed_pitchfx_count": 16,
#         "invalid_pitchfx_count": 16,
#         "total_at_bats_pitchfx_complete": 75,
#         "total_at_bats_patched_pitchfx": 0,
#         "total_at_bats_missing_pitchfx": 3,
#         "total_at_bats_removed_pitchfx": 11,
#         "total_at_bats_pitchfx_error": 0,
#         "total_at_bats_invalid_pitchfx": 3,
#         "at_bat_ids_pitchfx_complete": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_02_OAK_462136_BOS_502110_0",
#             "OAK201904030_02_OAK_462136_BOS_519048_0",
#             "OAK201904030_02_OAK_462136_BOS_456488_0",
#             "OAK201904030_02_OAK_462136_BOS_571788_0",
#             "OAK201904030_02_OAK_462136_BOS_596119_0",
#             "OAK201904030_02_BOS_543135_OAK_434778_0",
#             "OAK201904030_02_BOS_543135_OAK_595777_0",
#             "OAK201904030_02_BOS_543135_OAK_543760_0",
#             "OAK201904030_02_BOS_543135_OAK_657656_0",
#             "OAK201904030_02_BOS_543135_OAK_460026_0",
#             "OAK201904030_02_BOS_543135_OAK_543257_0",
#             "OAK201904030_02_BOS_543135_OAK_656305_0",
#             "OAK201904030_03_OAK_462136_BOS_598265_0",
#             "OAK201904030_03_OAK_462136_BOS_605141_0",
#             "OAK201904030_03_OAK_462136_BOS_643217_0",
#             "OAK201904030_03_BOS_543135_OAK_572039_0",
#             "OAK201904030_03_BOS_543135_OAK_501981_0",
#             "OAK201904030_03_BOS_543135_OAK_434778_0",
#             "OAK201904030_03_BOS_543135_OAK_595777_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_04_OAK_462136_BOS_502110_0",
#             "OAK201904030_04_OAK_462136_BOS_519048_0",
#             "OAK201904030_04_BOS_543135_OAK_543760_0",
#             "OAK201904030_04_BOS_543135_OAK_657656_0",
#             "OAK201904030_04_BOS_543135_OAK_460026_0",
#             "OAK201904030_04_BOS_543135_OAK_543257_0",
#             "OAK201904030_04_BOS_543135_OAK_656305_0",
#             "OAK201904030_05_OAK_462136_BOS_456488_0",
#             "OAK201904030_05_OAK_462136_BOS_571788_0",
#             "OAK201904030_05_OAK_462136_BOS_596119_0",
#             "OAK201904030_05_OAK_462136_BOS_598265_0",
#             "OAK201904030_05_BOS_543135_OAK_572039_0",
#             "OAK201904030_05_BOS_543135_OAK_501981_0",
#             "OAK201904030_05_BOS_543135_OAK_434778_0",
#             "OAK201904030_06_OAK_462136_BOS_605141_0",
#             "OAK201904030_06_OAK_462136_BOS_643217_0",
#             "OAK201904030_06_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_OAK_462136_BOS_502110_0",
#             "OAK201904030_06_OAK_488748_BOS_519048_0",
#             "OAK201904030_06_OAK_605525_BOS_456488_0",
#             "OAK201904030_06_OAK_605525_BOS_571788_0",
#             "OAK201904030_06_BOS_605155_OAK_595777_0",
#             "OAK201904030_06_BOS_605155_OAK_543760_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_06_BOS_605155_OAK_460026_0",
#             "OAK201904030_07_OAK_605525_BOS_596119_0",
#             "OAK201904030_07_OAK_605525_BOS_598265_0",
#             "OAK201904030_07_OAK_605525_BOS_605141_0",
#             "OAK201904030_07_OAK_605525_BOS_643217_0",
#             "OAK201904030_07_BOS_605155_OAK_543257_0",
#             "OAK201904030_07_BOS_605155_OAK_656305_0",
#             "OAK201904030_07_BOS_605155_OAK_572039_0",
#             "OAK201904030_07_BOS_598264_OAK_501981_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#             "OAK201904030_08_BOS_598264_OAK_543760_0",
#             "OAK201904030_08_BOS_598264_OAK_657656_0",
#             "OAK201904030_09_OAK_407845_BOS_456488_0",
#             "OAK201904030_09_OAK_407845_BOS_571788_0",
#             "OAK201904030_09_OAK_407845_BOS_596119_0",
#             "OAK201904030_09_OAK_407845_BOS_598265_0",
#             "OAK201904030_09_OAK_407845_BOS_605141_0",
#             "OAK201904030_09_OAK_433589_BOS_643217_0",
#             "OAK201904030_09_OAK_433589_BOS_646240_0",
#             "OAK201904030_09_BOS_518489_OAK_640461_0",
#             "OAK201904030_09_BOS_518489_OAK_543257_0",
#             "OAK201904030_09_BOS_518489_OAK_656305_0",
#             "OAK201904030_09_BOS_518489_OAK_572039_0",
#         ],
#         "at_bat_ids_patched_pitchfx": [],
#         "at_bat_ids_missing_pitchfx": [
#             "OAK201904030_08_OAK_465657_BOS_646240_0",
#             "OAK201904030_08_OAK_465657_BOS_502110_0",
#             "OAK201904030_08_OAK_465657_BOS_519048_0",
#         ],
#         "at_bat_ids_removed_pitchfx": [
#             "OAK201904030_01_OAK_462136_BOS_605141_0",
#             "OAK201904030_01_OAK_462136_BOS_643217_0",
#             "OAK201904030_01_OAK_462136_BOS_646240_0",
#             "OAK201904030_01_BOS_543135_OAK_543257_0",
#             "OAK201904030_01_BOS_543135_OAK_656305_0",
#             "OAK201904030_01_BOS_543135_OAK_572039_0",
#             "OAK201904030_01_BOS_543135_OAK_501981_0",
#             "OAK201904030_04_OAK_462136_BOS_646240_0",
#             "OAK201904030_06_BOS_605155_OAK_657656_0",
#             "OAK201904030_08_BOS_598264_OAK_434778_0",
#             "OAK201904030_08_BOS_598264_OAK_595777_0",
#         ],
#         "at_bat_ids_pitchfx_error": [],
#         "at_bat_ids_invalid_pitchfx": [
#             "OAK201904030_08_OAK_605525_BOS_646240_0",
#             "OAK201904030_08_OAK_605525_BOS_502110_0",
#             "OAK201904030_08_OAK_605525_BOS_519048_0",
#         ],
#     }

#     game_status = GameScrapeStatus.find_by_bbref_game_id(vig_app.db_session, GAME_ID_PATCH_PFX)
#     game_status.combined_data_success = 1
#     game_status.combined_data_fail = 0
#     vig_app.db_session.commit()
#     result = update_pitch_apps_with_combined_data(vig_app.db_session, combined_data)
#     assert result.success

#     patch_all_invalid_pfx = PatchAllInvalidPitchFxTask(vig_app)
#     result = patch_all_invalid_pfx.execute(2019)
#     assert result.success
#     patch_results_dict = result.value
#     assert "all_patch_results" in patch_results_dict
#     assert GAME_ID_PATCH_PFX in patch_results_dict["all_patch_results"]
#     vig_app.db_session.commit()


def test_combine_patched_boxscore_data(vig_app):
    test_id = "PATCH_BOXSCORE"
    create_test_data(vig_app, test_id)
    result = CombineScrapedDataTask(vig_app).execute(
        GAME_ID_PATCH_BOXSCORE, apply_patch_list=False, write_json=False, update_db=False
    )
    assert not result["combined_data_success"]
    assert "Invalid pitch abbreviation: a\nKeyError('a')" in result["error"]
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_PATCH_BOXSCORE, apply_patch_list=True)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 270,
        "pitch_count_bbref": 270,
        "pitch_count_pitchfx": 270,
        "batters_faced_bbref": 72,
        "batters_faced_pitchfx": 72,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 72,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "TOR201908170_01_TOR_663423_SEA_621005_0",
            "TOR201908170_01_TOR_663423_SEA_641487_0",
            "TOR201908170_01_TOR_663423_SEA_553882_0",
            "TOR201908170_01_SEA_596035_TOR_666182_0",
            "TOR201908170_01_SEA_596035_TOR_624415_0",
            "TOR201908170_01_SEA_596035_TOR_665489_0",
            "TOR201908170_02_TOR_663423_SEA_572122_0",
            "TOR201908170_02_TOR_663423_SEA_543592_0",
            "TOR201908170_02_TOR_663423_SEA_596129_0",
            "TOR201908170_02_TOR_663423_SEA_543829_0",
            "TOR201908170_02_TOR_663423_SEA_542979_0",
            "TOR201908170_02_TOR_663423_SEA_664238_0",
            "TOR201908170_02_TOR_663423_SEA_621005_0",
            "TOR201908170_02_SEA_596035_TOR_642133_0",
            "TOR201908170_02_SEA_596035_TOR_545341_0",
            "TOR201908170_02_SEA_596035_TOR_475253_0",
            "TOR201908170_02_SEA_596035_TOR_605233_0",
            "TOR201908170_02_SEA_596035_TOR_641856_0",
            "TOR201908170_02_SEA_596035_TOR_624512_0",
            "TOR201908170_03_TOR_663423_SEA_641487_0",
            "TOR201908170_03_TOR_663423_SEA_553882_0",
            "TOR201908170_03_TOR_663423_SEA_572122_0",
            "TOR201908170_03_SEA_518715_TOR_666182_0",
            "TOR201908170_03_SEA_518715_TOR_624415_0",
            "TOR201908170_03_SEA_518715_TOR_592273_0",
            "TOR201908170_04_TOR_663423_SEA_543592_0",
            "TOR201908170_04_TOR_663423_SEA_596129_0",
            "TOR201908170_04_TOR_663423_SEA_543829_0",
            "TOR201908170_04_TOR_663423_SEA_542979_0",
            "TOR201908170_04_TOR_663423_SEA_664238_0",
            "TOR201908170_04_SEA_518715_TOR_642133_0",
            "TOR201908170_04_SEA_518715_TOR_545341_0",
            "TOR201908170_04_SEA_518715_TOR_475253_0",
            "TOR201908170_04_SEA_607555_TOR_605233_0",
            "TOR201908170_05_TOR_663423_SEA_621005_0",
            "TOR201908170_05_TOR_663423_SEA_641487_0",
            "TOR201908170_05_TOR_663423_SEA_553882_0",
            "TOR201908170_05_TOR_663423_SEA_572122_0",
            "TOR201908170_05_SEA_607555_TOR_641856_0",
            "TOR201908170_05_SEA_607555_TOR_624512_0",
            "TOR201908170_05_SEA_607555_TOR_666182_0",
            "TOR201908170_05_SEA_607555_TOR_624415_0",
            "TOR201908170_05_SEA_665093_TOR_592273_0",
            "TOR201908170_05_SEA_665093_TOR_642133_0",
            "TOR201908170_06_TOR_663423_SEA_543592_0",
            "TOR201908170_06_TOR_663423_SEA_596129_0",
            "TOR201908170_06_TOR_663423_SEA_543829_0",
            "TOR201908170_06_SEA_665093_TOR_545341_0",
            "TOR201908170_06_SEA_665093_TOR_475253_0",
            "TOR201908170_06_SEA_665093_TOR_605233_0",
            "TOR201908170_06_SEA_665093_TOR_641856_0",
            "TOR201908170_07_TOR_543208_SEA_542979_0",
            "TOR201908170_07_TOR_543208_SEA_664238_0",
            "TOR201908170_07_TOR_543208_SEA_621005_0",
            "TOR201908170_07_SEA_542914_TOR_624512_0",
            "TOR201908170_07_SEA_542914_TOR_666182_0",
            "TOR201908170_07_SEA_542914_TOR_624415_0",
            "TOR201908170_07_SEA_542914_TOR_592273_0",
            "TOR201908170_08_TOR_641835_SEA_641487_0",
            "TOR201908170_08_TOR_641835_SEA_553882_0",
            "TOR201908170_08_TOR_641835_SEA_572122_0",
            "TOR201908170_08_TOR_571882_SEA_543592_0",
            "TOR201908170_08_SEA_592815_TOR_642133_0",
            "TOR201908170_08_SEA_592815_TOR_545341_0",
            "TOR201908170_08_SEA_592815_TOR_475253_0",
            "TOR201908170_09_TOR_571882_SEA_596129_0",
            "TOR201908170_09_TOR_571882_SEA_543829_0",
            "TOR201908170_09_TOR_571882_SEA_542979_0",
            "TOR201908170_09_SEA_543483_TOR_605233_0",
            "TOR201908170_09_SEA_543483_TOR_641856_0",
            "TOR201908170_09_SEA_543483_TOR_624512_0",
            "TOR201908170_09_SEA_543483_TOR_666182_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }


def test_combine_data_find_pfx_out_of_sequence(vig_app):
    test_id = "PFX_OUT_OF_SEQUENCE"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_PFX_OUT_OF_SEQUENCE, apply_patch_list=False)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 344,
        "pitch_count_bbref": 344,
        "pitch_count_pitchfx": 344,
        "batters_faced_bbref": 86,
        "batters_faced_pitchfx": 86,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 5,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 86,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 2,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "WAS201904030_01_WAS_434671_PHI_457705_0",
            "WAS201904030_01_WAS_434671_PHI_516416_0",
            "WAS201904030_01_WAS_434671_PHI_547180_0",
            "WAS201904030_01_WAS_434671_PHI_656555_0",
            "WAS201904030_01_WAS_434671_PHI_592663_0",
            "WAS201904030_01_WAS_434671_PHI_546318_0",
            "WAS201904030_01_PHI_605400_WAS_594809_0",
            "WAS201904030_01_PHI_605400_WAS_572821_0",
            "WAS201904030_01_PHI_605400_WAS_543685_0",
            "WAS201904030_01_PHI_605400_WAS_665742_0",
            "WAS201904030_01_PHI_605400_WAS_475582_0",
            "WAS201904030_01_PHI_605400_WAS_435559_0",
            "WAS201904030_02_WAS_434671_PHI_514917_0",
            "WAS201904030_02_WAS_434671_PHI_596748_0",
            "WAS201904030_02_WAS_434671_PHI_605400_0",
            "WAS201904030_02_PHI_605400_WAS_594694_0",
            "WAS201904030_02_PHI_605400_WAS_434671_0",
            "WAS201904030_02_PHI_605400_WAS_645302_0",
            "WAS201904030_03_WAS_434671_PHI_457705_0",
            "WAS201904030_03_WAS_434671_PHI_516416_0",
            "WAS201904030_03_WAS_434671_PHI_547180_0",
            "WAS201904030_03_WAS_434671_PHI_656555_0",
            "WAS201904030_03_PHI_605400_WAS_594809_0",
            "WAS201904030_03_PHI_605400_WAS_572821_0",
            "WAS201904030_03_PHI_605400_WAS_543685_0",
            "WAS201904030_03_PHI_605400_WAS_665742_0",
            "WAS201904030_03_PHI_605400_WAS_475582_0",
            "WAS201904030_03_PHI_605400_WAS_435559_0",
            "WAS201904030_03_PHI_605400_WAS_594694_0",
            "WAS201904030_04_WAS_434671_PHI_592663_0",
            "WAS201904030_04_WAS_434671_PHI_546318_0",
            "WAS201904030_04_WAS_434671_PHI_514917_0",
            "WAS201904030_04_WAS_434671_PHI_596748_0",
            "WAS201904030_04_WAS_434671_PHI_608384_0",
            "WAS201904030_04_WAS_434671_PHI_457705_0",
            "WAS201904030_04_WAS_434671_PHI_516416_0",
            "WAS201904030_04_PHI_591693_WAS_434671_0",
            "WAS201904030_04_PHI_591693_WAS_645302_0",
            "WAS201904030_04_PHI_591693_WAS_594809_0",
            "WAS201904030_04_PHI_591693_WAS_572821_0",
            "WAS201904030_05_WAS_594840_PHI_547180_0",
            "WAS201904030_05_WAS_594840_PHI_656555_0",
            "WAS201904030_05_WAS_594840_PHI_592663_0",
            "WAS201904030_05_WAS_594840_PHI_546318_0",
            "WAS201904030_05_WAS_594840_PHI_514917_0",
            "WAS201904030_05_PHI_591693_WAS_543685_0",
            "WAS201904030_05_PHI_591693_WAS_665742_0",
            "WAS201904030_05_PHI_591693_WAS_475582_0",
            "WAS201904030_05_PHI_504379_WAS_435559_0",
            "WAS201904030_06_WAS_502522_PHI_596748_0",
            "WAS201904030_06_WAS_502522_PHI_664068_0",
            "WAS201904030_06_WAS_502522_PHI_457705_0",
            "WAS201904030_06_PHI_504379_WAS_594694_0",
            "WAS201904030_06_PHI_504379_WAS_543228_0",
            "WAS201904030_06_PHI_504379_WAS_645302_0",
            "WAS201904030_06_PHI_504379_WAS_594809_0",
            "WAS201904030_06_PHI_504379_WAS_572821_0",
            "WAS201904030_07_WAS_502522_PHI_516416_0",
            "WAS201904030_07_WAS_502522_PHI_547180_0",
            "WAS201904030_07_WAS_502522_PHI_656555_0",
            "WAS201904030_07_WAS_502522_PHI_592663_0",
            "WAS201904030_07_PHI_593576_WAS_543685_0",
            "WAS201904030_07_PHI_593576_WAS_665742_0",
            "WAS201904030_07_PHI_593576_WAS_475582_0",
            "WAS201904030_08_WAS_448609_PHI_546318_0",
            "WAS201904030_08_WAS_448609_PHI_595284_0",
            "WAS201904030_08_WAS_572096_PHI_596748_0",
            "WAS201904030_08_WAS_572096_PHI_664068_0",
            "WAS201904030_08_WAS_607457_PHI_457705_0",
            "WAS201904030_08_WAS_607457_PHI_516416_0",
            "WAS201904030_08_WAS_607457_PHI_547180_0",
            "WAS201904030_08_WAS_607457_PHI_656555_0",
            "WAS201904030_08_WAS_607457_PHI_592663_0",
            "WAS201904030_08_PHI_622554_WAS_664057_0",
            "WAS201904030_08_PHI_622554_WAS_594694_0",
            "WAS201904030_08_PHI_622554_WAS_543228_0",
            "WAS201904030_08_PHI_622554_WAS_645302_0",
            "WAS201904030_08_PHI_622554_WAS_594809_0",
            "WAS201904030_08_PHI_622554_WAS_572821_0",
            "WAS201904030_09_WAS_448281_PHI_546318_0",
            "WAS201904030_09_WAS_448281_PHI_571437_0",
            "WAS201904030_09_WAS_448281_PHI_596748_0",
            "WAS201904030_09_PHI_502085_WAS_543685_0",
            "WAS201904030_09_PHI_502085_WAS_665742_0",
            "WAS201904030_09_PHI_502085_WAS_475582_0",
            "WAS201904030_09_PHI_502085_WAS_669738_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [
            "WAS201904030_01_WAS_434671_PHI_547180_0",
            "WAS201904030_08_WAS_607457_PHI_547180_0",
        ],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }


def test_combine_data_update_game_start_time(vig_app):
    test_id = "FIX_START_TIME"
    create_test_data(vig_app, test_id)
    combined_data = combine_scraped_data_for_game(vig_app, GAME_ID_FIX_START_TIME, apply_patch_list=False)
    assert "pitchfx_vs_bbref_audit" in combined_data
    assert combined_data["pitchfx_vs_bbref_audit"] == {
        "invalid_pitchfx": False,
        "pitchfx_error": False,
        "pitch_count_bbref_stats_table": 213,
        "pitch_count_bbref": 213,
        "pitch_count_pitchfx": 213,
        "batters_faced_bbref": 61,
        "batters_faced_pitchfx": 61,
        "patched_pitchfx_count": 0,
        "missing_pitchfx_count": 0,
        "removed_pitchfx_count": 0,
        "invalid_pitchfx_count": 0,
        "total_at_bats_pitchfx_complete": 61,
        "total_at_bats_patched_pitchfx": 0,
        "total_at_bats_missing_pitchfx": 0,
        "total_at_bats_removed_pitchfx": 0,
        "total_at_bats_pitchfx_error": 0,
        "total_at_bats_invalid_pitchfx": 0,
        "at_bat_ids_pitchfx_complete": [
            "TBA201909032_01_TBA_552640_BAL_542340_0",
            "TBA201909032_01_TBA_552640_BAL_592863_0",
            "TBA201909032_01_TBA_552640_BAL_623993_0",
            "TBA201909032_01_TBA_552640_BAL_600524_0",
            "TBA201909032_01_BAL_593679_TBA_519299_0",
            "TBA201909032_01_BAL_593679_TBA_502054_0",
            "TBA201909032_01_BAL_593679_TBA_640457_0",
            "TBA201909032_02_TBA_656222_BAL_596105_0",
            "TBA201909032_02_TBA_656222_BAL_600474_0",
            "TBA201909032_02_TBA_656222_BAL_547004_0",
            "TBA201909032_02_BAL_593679_TBA_518595_0",
            "TBA201909032_02_BAL_593679_TBA_596847_0",
            "TBA201909032_02_BAL_593679_TBA_541645_0",
            "TBA201909032_03_TBA_656222_BAL_448801_0",
            "TBA201909032_03_TBA_656222_BAL_621006_0",
            "TBA201909032_03_TBA_656222_BAL_542340_0",
            "TBA201909032_03_TBA_656222_BAL_592863_0",
            "TBA201909032_03_BAL_593679_TBA_595281_0",
            "TBA201909032_03_BAL_593679_TBA_642715_0",
            "TBA201909032_03_BAL_593679_TBA_621563_0",
            "TBA201909032_03_BAL_593679_TBA_519299_0",
            "TBA201909032_04_TBA_650895_BAL_623993_0",
            "TBA201909032_04_TBA_650895_BAL_600524_0",
            "TBA201909032_04_TBA_650895_BAL_596105_0",
            "TBA201909032_04_BAL_593679_TBA_502054_0",
            "TBA201909032_04_BAL_593679_TBA_640457_0",
            "TBA201909032_04_BAL_593679_TBA_518595_0",
            "TBA201909032_04_BAL_593679_TBA_596847_0",
            "TBA201909032_05_TBA_650895_BAL_600474_0",
            "TBA201909032_05_TBA_650895_BAL_547004_0",
            "TBA201909032_05_TBA_650895_BAL_448801_0",
            "TBA201909032_05_BAL_593679_TBA_541645_0",
            "TBA201909032_05_BAL_593679_TBA_595281_0",
            "TBA201909032_05_BAL_593679_TBA_642715_0",
            "TBA201909032_05_BAL_593679_TBA_621563_0",
            "TBA201909032_06_TBA_621363_BAL_621006_0",
            "TBA201909032_06_TBA_621363_BAL_542340_0",
            "TBA201909032_06_TBA_621363_BAL_592863_0",
            "TBA201909032_06_TBA_621363_BAL_623993_0",
            "TBA201909032_06_BAL_593679_TBA_519299_0",
            "TBA201909032_06_BAL_593679_TBA_502054_0",
            "TBA201909032_06_BAL_593679_TBA_640457_0",
            "TBA201909032_07_TBA_475054_BAL_600524_0",
            "TBA201909032_07_TBA_475054_BAL_596105_0",
            "TBA201909032_07_TBA_623433_BAL_621466_0",
            "TBA201909032_07_BAL_593679_TBA_518595_0",
            "TBA201909032_07_BAL_593679_TBA_596847_0",
            "TBA201909032_07_BAL_593679_TBA_541645_0",
            "TBA201909032_07_BAL_643316_TBA_595281_0",
            "TBA201909032_08_TBA_623433_BAL_547004_0",
            "TBA201909032_08_TBA_623433_BAL_448801_0",
            "TBA201909032_08_TBA_623433_BAL_641820_0",
            "TBA201909032_08_BAL_643316_TBA_642715_0",
            "TBA201909032_08_BAL_643316_TBA_621563_0",
            "TBA201909032_08_BAL_643316_TBA_519299_0",
            "TBA201909032_08_BAL_612434_TBA_502054_0",
            "TBA201909032_08_BAL_612434_TBA_640457_0",
            "TBA201909032_08_BAL_612434_TBA_518595_0",
            "TBA201909032_09_TBA_641941_BAL_542340_0",
            "TBA201909032_09_TBA_641941_BAL_592863_0",
            "TBA201909032_09_TBA_641941_BAL_623993_0",
        ],
        "at_bat_ids_patched_pitchfx": [],
        "at_bat_ids_missing_pitchfx": [],
        "at_bat_ids_removed_pitchfx": [],
        "at_bat_ids_pitchfx_error": [],
        "at_bat_ids_invalid_pitchfx": [],
    }
