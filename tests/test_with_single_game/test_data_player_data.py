from dacite.core import from_dict

from vigorish.data.metrics import BatStatsMetrics, PitchFxMetricsCollection, PitchStatsMetrics
from vigorish.data.player_data import PlayerData
from vigorish.enums import DefensePosition, PitchType

from .conftest import BBREF_GAME_ID


def test_bat_stats(vig_app):
    bat_stats_for_career_dict = {
        "year": 0,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "",
        "mlb_id": 545361,
        "bbref_id": "troutmi01",
        "stint_number": 0,
        "total_games": 1,
        "avg": 0.8,
        "obp": 0.8,
        "slg": 1.6,
        "ops": 2.4,
        "iso": 0.8,
        "bb_rate": 0.0,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "plate_appearances": 5,
        "at_bats": 5,
        "hits": 4,
        "runs_scored": 2,
        "rbis": 3,
        "bases_on_balls": 0,
        "strikeouts": 0,
        "doubles": 1,
        "triples": 0,
        "homeruns": 1,
        "stolen_bases": 0,
        "caught_stealing": 1,
        "hit_by_pitch": 0,
        "intentional_bb": 0,
        "gdp": 0,
        "sac_fly": 0,
        "sac_hit": 0,
        "total_pitches": 19,
        "total_strikes": 11,
        "wpa_bat": 0.145,
        "wpa_bat_pos": 0.166,
        "wpa_bat_neg": -0.021,
        "re24_bat": 2.9,
    }

    bat_stats_by_year_dict = {
        "year": 2019,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "",
        "mlb_id": 545361,
        "bbref_id": "troutmi01",
        "stint_number": 0,
        "total_games": 1,
        "avg": 0.8,
        "obp": 0.8,
        "slg": 1.6,
        "ops": 2.4,
        "iso": 0.8,
        "bb_rate": 0.0,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "plate_appearances": 5,
        "at_bats": 5,
        "hits": 4,
        "runs_scored": 2,
        "rbis": 3,
        "bases_on_balls": 0,
        "strikeouts": 0,
        "doubles": 1,
        "triples": 0,
        "homeruns": 1,
        "stolen_bases": 0,
        "caught_stealing": 1,
        "hit_by_pitch": 0,
        "intentional_bb": 0,
        "gdp": 0,
        "sac_fly": 0,
        "sac_hit": 0,
        "total_pitches": 19,
        "total_strikes": 11,
        "wpa_bat": 0.145,
        "wpa_bat_pos": 0.166,
        "wpa_bat_neg": -0.021,
        "re24_bat": 2.9,
    }

    bat_stats_by_team_dict = {
        "at_bats": 5,
        "avg": 0.8,
        "bases_on_balls": 0,
        "bat_order": 0,
        "bb_rate": 0.0,
        "bbref_id": "troutmi01",
        "caught_stealing": 1,
        "def_position": DefensePosition.NONE,
        "doubles": 1,
        "gdp": 0,
        "hit_by_pitch": 0,
        "hits": 4,
        "homeruns": 1,
        "intentional_bb": 0,
        "is_starter": False,
        "iso": 0.8,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "mlb_id": 545361,
        "obp": 0.8,
        "opponent_team_id_bbref": "",
        "ops": 2.4,
        "plate_appearances": 5,
        "rbis": 3,
        "re24_bat": 2.9,
        "runs_scored": 2,
        "sac_fly": 0,
        "sac_hit": 0,
        "slg": 1.6,
        "stint_number": 0,
        "stolen_bases": 0,
        "strikeouts": 0,
        "team_id_bbref": "",
        "total_games": 1,
        "total_pitches": 19,
        "total_strikes": 11,
        "triples": 0,
        "wpa_bat": 0.145,
        "wpa_bat_neg": -0.021,
        "wpa_bat_pos": 0.166,
        "year": 0,
    }

    bat_stats_by_team_by_year_dict = {
        "at_bats": 5,
        "avg": 0.8,
        "bases_on_balls": 0,
        "bat_order": 0,
        "bb_rate": 0.0,
        "bbref_id": "troutmi01",
        "caught_stealing": 1,
        "def_position": DefensePosition.NONE,
        "doubles": 1,
        "gdp": 0,
        "hit_by_pitch": 0,
        "hits": 4,
        "homeruns": 1,
        "intentional_bb": 0,
        "is_starter": False,
        "iso": 0.8,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "mlb_id": 545361,
        "obp": 0.8,
        "opponent_team_id_bbref": "",
        "ops": 2.4,
        "plate_appearances": 5,
        "rbis": 3,
        "re24_bat": 2.9,
        "runs_scored": 2,
        "sac_fly": 0,
        "sac_hit": 0,
        "slg": 1.6,
        "stint_number": 1,
        "stolen_bases": 0,
        "strikeouts": 0,
        "team_id_bbref": "",
        "total_games": 1,
        "total_pitches": 19,
        "total_strikes": 11,
        "triples": 0,
        "wpa_bat": 0.145,
        "wpa_bat_neg": -0.021,
        "wpa_bat_pos": 0.166,
        "year": 2019,
    }

    bat_stats_by_opp_team_dict = {
        "at_bats": 5,
        "avg": 0.8,
        "bases_on_balls": 0,
        "bat_order": 0,
        "bb_rate": 0.0,
        "bbref_id": "troutmi01",
        "caught_stealing": 1,
        "def_position": DefensePosition.NONE,
        "doubles": 1,
        "gdp": 0,
        "hit_by_pitch": 0,
        "hits": 4,
        "homeruns": 1,
        "intentional_bb": 0,
        "is_starter": False,
        "iso": 0.8,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "mlb_id": 545361,
        "obp": 0.8,
        "opponent_team_id_bbref": "TOR",
        "ops": 2.4,
        "plate_appearances": 5,
        "rbis": 3,
        "re24_bat": 2.9,
        "runs_scored": 2,
        "sac_fly": 0,
        "sac_hit": 0,
        "slg": 1.6,
        "stint_number": 0,
        "stolen_bases": 0,
        "strikeouts": 0,
        "team_id_bbref": "",
        "total_games": 1,
        "total_pitches": 19,
        "total_strikes": 11,
        "triples": 0,
        "wpa_bat": 0.145,
        "wpa_bat_neg": -0.021,
        "wpa_bat_pos": 0.166,
        "year": 0,
    }

    bat_stats_by_opp_team_by_year_dict = {
        "at_bats": 5,
        "avg": 0.8,
        "bases_on_balls": 0,
        "bat_order": 0,
        "bb_rate": 0.0,
        "bbref_id": "troutmi01",
        "caught_stealing": 1,
        "def_position": DefensePosition.NONE,
        "doubles": 1,
        "gdp": 0,
        "hit_by_pitch": 0,
        "hits": 4,
        "homeruns": 1,
        "intentional_bb": 0,
        "is_starter": False,
        "iso": 0.8,
        "k_rate": 0.0,
        "contact_rate": 1.0,
        "mlb_id": 545361,
        "obp": 0.8,
        "opponent_team_id_bbref": "TOR",
        "ops": 2.4,
        "plate_appearances": 5,
        "rbis": 3,
        "re24_bat": 2.9,
        "runs_scored": 2,
        "sac_fly": 0,
        "sac_hit": 0,
        "slg": 1.6,
        "stint_number": 0,
        "stolen_bases": 0,
        "strikeouts": 0,
        "team_id_bbref": "",
        "total_games": 1,
        "total_pitches": 19,
        "total_strikes": 11,
        "triples": 0,
        "wpa_bat": 0.145,
        "wpa_bat_neg": -0.021,
        "wpa_bat_pos": 0.166,
        "year": 2019,
    }

    bat_stats_for_career = from_dict(data_class=BatStatsMetrics, data=bat_stats_for_career_dict)
    bat_stats_by_year = from_dict(data_class=BatStatsMetrics, data=bat_stats_by_year_dict)
    bat_stats_by_team = from_dict(data_class=BatStatsMetrics, data=bat_stats_by_team_dict)
    bat_stats_by_team_by_year = from_dict(data_class=BatStatsMetrics, data=bat_stats_by_team_by_year_dict)
    bat_stats_by_opp_team = from_dict(data_class=BatStatsMetrics, data=bat_stats_by_opp_team_dict)
    bat_stats_by_opp_team_by_year = from_dict(data_class=BatStatsMetrics, data=bat_stats_by_opp_team_by_year_dict)

    player_data = PlayerData(vig_app, 545361)
    assert player_data.bat_stats_for_career == bat_stats_for_career
    assert player_data.bat_stats_by_year == [bat_stats_by_year]
    assert player_data.bat_stats_by_team == [bat_stats_by_team]
    assert player_data.bat_stats_by_team_by_year == [bat_stats_by_team_by_year]
    assert player_data.bat_stats_by_opp_team == [bat_stats_by_opp_team]
    assert player_data.bat_stats_by_opp_team_by_year == [bat_stats_by_opp_team_by_year]


def test_pitch_stats(vig_app):
    pitch_stats_for_career_dict = {
        "year": 0,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_as_sp_dict = {
        "year": 0,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_as_rp = None

    pitch_stats_by_year_dict = {
        "year": 2019,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_by_team_dict = {
        "year": 0,
        "team_id_bbref": "TOR",
        "opponent_team_id_bbref": "",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_by_team_by_year_dict = {
        "year": 2019,
        "team_id_bbref": "TOR",
        "opponent_team_id_bbref": "",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 1,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_by_opp_team_dict = {
        "year": 0,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "LAA",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_by_opp_team_by_year_dict = {
        "year": 2019,
        "team_id_bbref": "",
        "opponent_team_id_bbref": "LAA",
        "mlb_id": 571882,
        "bbref_id": "lawde01",
        "stint_number": 0,
        "total_games": 1,
        "games_as_sp": 1,
        "games_as_rp": 0,
        "wins": 0,
        "losses": 0,
        "saves": 0,
        "innings_pitched": 1.0,
        "total_outs": 3,
        "batters_faced": 3,
        "runs": 0,
        "earned_runs": 0,
        "hits": 0,
        "homeruns": 0,
        "strikeouts": 2,
        "bases_on_balls": 0,
        "era": 0.0,
        "whip": 0.0,
        "k_per_nine": 18.0,
        "bb_per_nine": 0.0,
        "hr_per_nine": 0.0,
        "k_per_bb": 0.0,
        "k_rate": 0.667,
        "bb_rate": 0.0,
        "k_minus_bb": 0.667,
        "hr_per_fb": 0.0,
        "pitch_count": 17,
        "strikes": 11,
        "strikes_contact": 4,
        "strikes_swinging": 2,
        "strikes_looking": 5,
        "ground_balls": 0,
        "fly_balls": 1,
        "line_drives": 1,
        "unknown_type": 0,
        "inherited_runners": 0,
        "inherited_scored": 0,
        "wpa_pitch": 0.049,
        "re24_pitch": 0.5,
    }

    pitch_stats_for_career = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_for_career_dict)
    pitch_stats_as_sp = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_as_sp_dict)
    pitch_stats_as_rp = None
    pitch_stats_by_year = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_by_year_dict)
    pitch_stats_by_team = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_by_team_dict)
    pitch_stats_by_team_by_year = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_by_team_by_year_dict)
    pitch_stats_by_opp_team = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_by_opp_team_dict)
    pitch_stats_by_opp_team_by_year = from_dict(data_class=PitchStatsMetrics, data=pitch_stats_by_opp_team_by_year_dict)

    player_data = PlayerData(vig_app, 571882)
    assert player_data.pitch_stats_for_career == pitch_stats_for_career
    assert player_data.pitch_stats_as_sp == pitch_stats_as_sp
    assert player_data.pitch_stats_as_rp == pitch_stats_as_rp
    assert player_data.pitch_stats_by_year == [pitch_stats_by_year]
    assert player_data.pitch_stats_by_team == [pitch_stats_by_team]
    assert player_data.pitch_stats_by_team_by_year == [pitch_stats_by_team_by_year]
    assert player_data.pitch_stats_by_opp_team == [pitch_stats_by_opp_team]
    assert player_data.pitch_stats_by_opp_team_by_year == [pitch_stats_by_opp_team_by_year]


def test_pitchfx_metrics_career(vig_app):
    pfx_metrics_career_ALL_dict = {
        "avg": 0.0,
        "avg_break_angle": 0.0,
        "avg_break_length": 0.0,
        "avg_break_y": 0.0,
        "avg_extension": 0.0,
        "avg_hit_distance": 328.0,
        "avg_launch_angle": 27.0,
        "avg_launch_speed": 85.3,
        "avg_pfx_x": 0.0,
        "avg_pfx_z": 0.0,
        "avg_plate_time": 0.0,
        "avg_px": 0.0,
        "avg_pz": 0.0,
        "avg_speed": 0.0,
        "avg_spin_direction": 0.0,
        "avg_spin_rate": 0.0,
        "barrel_rate": 0.0,
        "bb_rate": 0.0,
        "called_strike_rate": 0.294,
        "contact_rate": 0.667,
        "csw_rate": 0.412,
        "fly_ball_rate": 0.0,
        "ground_ball_rate": 0.0,
        "hard_hit_rate": 0.0,
        "hr_per_fb": 0.0,
        "iso": 0.0,
        "k_rate": 0.667,
        "line_drive_rate": 1.0,
        "medium_hit_rate": 1.0,
        "mlb_id": 571882,
        "o_contact_rate": 0.667,
        "o_swing_rate": 0.3,
        "obp": 0.0,
        "ops": 0.0,
        "p_throws": "R",
        "percent": 1.0,
        "pitch_type": PitchType(32803),
        "pitch_type_int": 32803,
        "popup_rate": 0.0,
        "slg": 0.0,
        "soft_hit_rate": 0.0,
        "swing_rate": 0.353,
        "swinging_strike_rate": 0.118,
        "total_at_bats": 3,
        "total_balls_in_play": 1,
        "total_barrels": 0,
        "total_bb": 0,
        "total_called_strikes": 5,
        "total_contact_inside_zone": 2,
        "total_contact_outside_zone": 2,
        "total_doubles": 0,
        "total_errors": 0,
        "total_fly_balls": 0,
        "total_ground_balls": 0,
        "total_hard_hits": 0,
        "total_hbp": 0,
        "total_hits": 0,
        "total_homeruns": 0,
        "total_ibb": 0,
        "total_inside_strike_zone": 7,
        "total_k": 2,
        "total_line_drives": 1,
        "total_medium_hits": 1,
        "total_outs": 3,
        "total_outside_strike_zone": 10,
        "total_pa": 3,
        "total_pitches": 17,
        "total_popups": 0,
        "total_sac_fly": 0,
        "total_sac_hit": 0,
        "total_singles": 0,
        "total_soft_hits": 0,
        "total_swinging_strikes": 2,
        "total_swings": 6,
        "total_swings_inside_zone": 3,
        "total_swings_made_contact": 4,
        "total_swings_outside_zone": 3,
        "total_triples": 0,
        "whiff_rate": 0.333,
        "z_contact_rate": 0.667,
        "z_swing_rate": 0.429,
        "zone_rate": 0.412,
    }

    pfx_metrics_career_CU_dict = {
        "avg": 0.0,
        "avg_break_angle": 5.4,
        "avg_break_length": 13.2,
        "avg_break_y": 24.0,
        "avg_extension": 5.822,
        "avg_hit_distance": 0.0,
        "avg_launch_angle": 0.0,
        "avg_launch_speed": 0.0,
        "avg_pfx_x": 3.045,
        "avg_pfx_z": -5.965,
        "avg_plate_time": 0.502,
        "avg_px": 0.23,
        "avg_pz": 1.587,
        "avg_speed": 76.175,
        "avg_spin_direction": 26.75,
        "avg_spin_rate": 2056.25,
        "barrel_rate": 0.0,
        "bb_rate": 0.0,
        "called_strike_rate": 0.5,
        "contact_rate": 0.0,
        "csw_rate": 0.5,
        "fly_ball_rate": 0.0,
        "ground_ball_rate": 0.0,
        "hard_hit_rate": 0.0,
        "hr_per_fb": 0.0,
        "iso": 0.0,
        "k_rate": 0.0,
        "line_drive_rate": 0.0,
        "medium_hit_rate": 0.0,
        "mlb_id": 571882,
        "o_contact_rate": 0.0,
        "o_swing_rate": 0.0,
        "obp": 0.0,
        "ops": 0.0,
        "p_throws": "R",
        "percent": 0.235,
        "pitch_type": PitchType.CURVEBALL,
        "pitch_type_int": 2,
        "popup_rate": 0.0,
        "slg": 0.0,
        "soft_hit_rate": 0.0,
        "swing_rate": 0.0,
        "swinging_strike_rate": 0.0,
        "total_at_bats": 0,
        "total_balls_in_play": 0,
        "total_barrels": 0,
        "total_bb": 0,
        "total_called_strikes": 2,
        "total_contact_inside_zone": 0,
        "total_contact_outside_zone": 0,
        "total_doubles": 0,
        "total_errors": 0,
        "total_fly_balls": 0,
        "total_ground_balls": 0,
        "total_hard_hits": 0,
        "total_hbp": 0,
        "total_hits": 0,
        "total_homeruns": 0,
        "total_ibb": 0,
        "total_inside_strike_zone": 2,
        "total_k": 0,
        "total_line_drives": 0,
        "total_medium_hits": 0,
        "total_outs": 0,
        "total_outside_strike_zone": 2,
        "total_pa": 0,
        "total_pitches": 4,
        "total_popups": 0,
        "total_sac_fly": 0,
        "total_sac_hit": 0,
        "total_singles": 0,
        "total_soft_hits": 0,
        "total_swinging_strikes": 0,
        "total_swings": 0,
        "total_swings_inside_zone": 0,
        "total_swings_made_contact": 0,
        "total_swings_outside_zone": 0,
        "total_triples": 0,
        "whiff_rate": 0.0,
        "z_contact_rate": 0.0,
        "z_swing_rate": 0.0,
        "zone_rate": 0.5,
    }

    pfx_metrics_career_FF_dict = {
        "avg": 0.0,
        "avg_break_angle": 8.4,
        "avg_break_length": 3.6,
        "avg_break_y": 24.0,
        "avg_extension": 6.613,
        "avg_hit_distance": 328.0,
        "avg_launch_angle": 27.0,
        "avg_launch_speed": 85.3,
        "avg_pfx_x": -1.252,
        "avg_pfx_z": 8.577,
        "avg_plate_time": 0.398,
        "avg_px": 0.048,
        "avg_pz": 3.302,
        "avg_speed": 94.017,
        "avg_spin_direction": 186.333,
        "avg_spin_rate": 2150.0,
        "barrel_rate": 0.0,
        "bb_rate": 0.0,
        "called_strike_rate": 0.167,
        "contact_rate": 1.0,
        "csw_rate": 0.167,
        "fly_ball_rate": 0.0,
        "ground_ball_rate": 0.0,
        "hard_hit_rate": 0.0,
        "hr_per_fb": 0.0,
        "iso": 0.0,
        "k_rate": 0.0,
        "line_drive_rate": 1.0,
        "medium_hit_rate": 1.0,
        "mlb_id": 571882,
        "o_contact_rate": 1.0,
        "o_swing_rate": 0.2,
        "obp": 0.0,
        "ops": 0.0,
        "p_throws": "R",
        "percent": 0.353,
        "pitch_type": PitchType.FOUR_SEAM_FASTBALL,
        "pitch_type_int": 32,
        "popup_rate": 0.0,
        "slg": 0.0,
        "soft_hit_rate": 0.0,
        "swing_rate": 0.333,
        "swinging_strike_rate": 0.0,
        "total_at_bats": 1,
        "total_balls_in_play": 1,
        "total_barrels": 0,
        "total_bb": 0,
        "total_called_strikes": 1,
        "total_contact_inside_zone": 1,
        "total_contact_outside_zone": 1,
        "total_doubles": 0,
        "total_errors": 0,
        "total_fly_balls": 0,
        "total_ground_balls": 0,
        "total_hard_hits": 0,
        "total_hbp": 0,
        "total_hits": 0,
        "total_homeruns": 0,
        "total_ibb": 0,
        "total_inside_strike_zone": 1,
        "total_k": 0,
        "total_line_drives": 1,
        "total_medium_hits": 1,
        "total_outs": 1,
        "total_outside_strike_zone": 5,
        "total_pa": 1,
        "total_pitches": 6,
        "total_popups": 0,
        "total_sac_fly": 0,
        "total_sac_hit": 0,
        "total_singles": 0,
        "total_soft_hits": 0,
        "total_swinging_strikes": 0,
        "total_swings": 2,
        "total_swings_inside_zone": 1,
        "total_swings_made_contact": 2,
        "total_swings_outside_zone": 1,
        "total_triples": 0,
        "whiff_rate": 0.0,
        "z_contact_rate": 1.0,
        "z_swing_rate": 1.0,
        "zone_rate": 0.167,
    }

    pfx_metrics_career_CH_dict = {
        "avg": 0.0,
        "avg_break_angle": 22.8,
        "avg_break_length": 6.4,
        "avg_break_y": 24.0,
        "avg_extension": 6.553,
        "avg_hit_distance": 0.0,
        "avg_launch_angle": 0.0,
        "avg_launch_speed": 0.0,
        "avg_pfx_x": -6.377,
        "avg_pfx_z": 6.993,
        "avg_plate_time": 0.437,
        "avg_px": -0.2,
        "avg_pz": 2.37,
        "avg_speed": 85.833,
        "avg_spin_direction": 222.0,
        "avg_spin_rate": 1967.333,
        "barrel_rate": 0.0,
        "bb_rate": 0.0,
        "called_strike_rate": 0.333,
        "contact_rate": 0.5,
        "csw_rate": 0.667,
        "fly_ball_rate": 0.0,
        "ground_ball_rate": 0.0,
        "hard_hit_rate": 0.0,
        "hr_per_fb": 0.0,
        "iso": 0.0,
        "k_rate": 1.0,
        "line_drive_rate": 0.0,
        "medium_hit_rate": 0.0,
        "mlb_id": 571882,
        "o_contact_rate": 0.0,
        "o_swing_rate": 0.0,
        "obp": 0.0,
        "ops": 0.0,
        "p_throws": "R",
        "percent": 0.176,
        "pitch_type": PitchType.CHANGEUP,
        "pitch_type_int": 1,
        "popup_rate": 0.0,
        "slg": 0.0,
        "soft_hit_rate": 0.0,
        "swing_rate": 0.667,
        "swinging_strike_rate": 0.333,
        "total_at_bats": 1,
        "total_balls_in_play": 0,
        "total_barrels": 0,
        "total_bb": 0,
        "total_called_strikes": 1,
        "total_contact_inside_zone": 1,
        "total_contact_outside_zone": 0,
        "total_doubles": 0,
        "total_errors": 0,
        "total_fly_balls": 0,
        "total_ground_balls": 0,
        "total_hard_hits": 0,
        "total_hbp": 0,
        "total_hits": 0,
        "total_homeruns": 0,
        "total_ibb": 0,
        "total_inside_strike_zone": 3,
        "total_k": 1,
        "total_line_drives": 0,
        "total_medium_hits": 0,
        "total_outs": 1,
        "total_outside_strike_zone": 0,
        "total_pa": 1,
        "total_pitches": 3,
        "total_popups": 0,
        "total_sac_fly": 0,
        "total_sac_hit": 0,
        "total_singles": 0,
        "total_soft_hits": 0,
        "total_swinging_strikes": 1,
        "total_swings": 2,
        "total_swings_inside_zone": 2,
        "total_swings_made_contact": 1,
        "total_swings_outside_zone": 0,
        "total_triples": 0,
        "whiff_rate": 0.5,
        "z_contact_rate": 0.5,
        "z_swing_rate": 0.667,
        "zone_rate": 1.0,
    }

    pfx_metrics_career_SL_dict = {
        "avg": 0.0,
        "avg_break_angle": 6.0,
        "avg_break_length": 9.6,
        "avg_break_y": 24.0,
        "avg_extension": 6.075,
        "avg_hit_distance": 0.0,
        "avg_launch_angle": 0.0,
        "avg_launch_speed": 0.0,
        "avg_pfx_x": 2.285,
        "avg_pfx_z": -1.922,
        "avg_plate_time": 0.45,
        "avg_px": 0.407,
        "avg_pz": 1.35,
        "avg_speed": 83.725,
        "avg_spin_direction": 48.0,
        "avg_spin_rate": 2281.0,
        "barrel_rate": 0.0,
        "bb_rate": 0.0,
        "called_strike_rate": 0.25,
        "contact_rate": 0.5,
        "csw_rate": 0.5,
        "fly_ball_rate": 0.0,
        "ground_ball_rate": 0.0,
        "hard_hit_rate": 0.0,
        "hr_per_fb": 0.0,
        "iso": 0.0,
        "k_rate": 1.0,
        "line_drive_rate": 0.0,
        "medium_hit_rate": 0.0,
        "mlb_id": 571882,
        "o_contact_rate": 0.5,
        "o_swing_rate": 0.667,
        "obp": 0.0,
        "ops": 0.0,
        "p_throws": "R",
        "percent": 0.235,
        "pitch_type": PitchType.SLIDER,
        "pitch_type_int": 32768,
        "popup_rate": 0.0,
        "slg": 0.0,
        "soft_hit_rate": 0.0,
        "swing_rate": 0.5,
        "swinging_strike_rate": 0.25,
        "total_at_bats": 1,
        "total_balls_in_play": 0,
        "total_barrels": 0,
        "total_bb": 0,
        "total_called_strikes": 1,
        "total_contact_inside_zone": 0,
        "total_contact_outside_zone": 1,
        "total_doubles": 0,
        "total_errors": 0,
        "total_fly_balls": 0,
        "total_ground_balls": 0,
        "total_hard_hits": 0,
        "total_hbp": 0,
        "total_hits": 0,
        "total_homeruns": 0,
        "total_ibb": 0,
        "total_inside_strike_zone": 1,
        "total_k": 1,
        "total_line_drives": 0,
        "total_medium_hits": 0,
        "total_outs": 1,
        "total_outside_strike_zone": 3,
        "total_pa": 1,
        "total_pitches": 4,
        "total_popups": 0,
        "total_sac_fly": 0,
        "total_sac_hit": 0,
        "total_singles": 0,
        "total_soft_hits": 0,
        "total_swinging_strikes": 1,
        "total_swings": 2,
        "total_swings_inside_zone": 0,
        "total_swings_made_contact": 1,
        "total_swings_outside_zone": 2,
        "total_triples": 0,
        "whiff_rate": 0.5,
        "z_contact_rate": 0.0,
        "z_swing_rate": 0.0,
        "zone_rate": 0.25,
    }

    pfx_metrics_career_by_pitchtype = [
        pfx_metrics_career_CU_dict,
        pfx_metrics_career_FF_dict,
        pfx_metrics_career_CH_dict,
        pfx_metrics_career_SL_dict,
    ]
    pfx_metrics_career_ALL = PitchFxMetricsCollection.from_query_results(
        pfx_metrics_career_ALL_dict, pfx_metrics_career_by_pitchtype
    )
    assert isinstance(pfx_metrics_career_ALL, PitchFxMetricsCollection)

    player_data = PlayerData(vig_app, 571882)
    assert player_data.pfx_pitching_metrics_vs_all_for_career
    assert player_data.percentiles_for_pitch_types_for_career
    assert player_data.pfx_pitching_metrics_vs_rhb_for_career
    assert player_data.percentiles_for_pitch_types_vs_rhb_for_career
    assert player_data.pfx_pitching_metrics_vs_lhb_for_career
    assert player_data.percentiles_for_pitch_types_vs_lhb_for_career
    assert player_data.pfx_pitching_metrics_vs_all_by_year
    assert player_data.percentiles_for_pitch_types_by_year
    assert player_data.pfx_pitching_metrics_vs_rhb_by_year
    assert player_data.percentiles_for_pitch_types_vs_rhb_by_year
    assert player_data.pfx_pitching_metrics_vs_lhb_by_year
    assert player_data.percentiles_for_pitch_types_vs_lhb_by_year
    assert player_data.get_pfx_pitching_metrics_vs_all_for_season(2019)
    assert player_data.get_pfx_pitching_metrics_vs_rhb_for_season(2019)
    assert player_data.get_pfx_pitching_metrics_vs_lhb_for_season(2019)
    assert player_data.get_pfx_pitching_metrics_vs_all_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_pitching_metrics_vs_rhb_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_pitching_metrics_vs_lhb_for_game(BBREF_GAME_ID)
    assert player_data.get_all_pfx_career_data()
    assert player_data.get_all_pfx_yearly_data()

    player_data = PlayerData(vig_app, 600303)
    assert player_data.pfx_batting_metrics_vs_all_for_career
    assert player_data.pfx_batting_metrics_vs_rhp_for_career
    assert player_data.pfx_batting_metrics_vs_lhp_for_career
    assert player_data.pfx_batting_metrics_vs_rhp_as_lhb_for_career
    assert player_data.pfx_batting_metrics_vs_lhp_as_lhb_for_career
    assert player_data.pfx_batting_metrics_by_year
    assert player_data.get_pfx_batting_metrics_vs_all_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_batting_metrics_vs_rhp_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_batting_metrics_vs_lhp_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_batting_metrics_vs_rhp_as_lhb_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_batting_metrics_vs_lhp_as_lhb_for_game(BBREF_GAME_ID)
    assert player_data.get_all_pfx_batting_career_data()
    assert player_data.get_all_pfx_batting_yearly_data()

    player_data = PlayerData(vig_app, 545361)
    assert player_data.pfx_batting_metrics_vs_rhp_as_rhb_for_career
    assert player_data.pfx_batting_metrics_vs_lhp_as_rhb_for_career
    assert player_data.get_pfx_batting_metrics_vs_rhp_as_rhb_for_game(BBREF_GAME_ID)
    assert player_data.get_pfx_batting_metrics_vs_lhp_as_rhb_for_game(BBREF_GAME_ID)
